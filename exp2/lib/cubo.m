clear; close all;
load('data/EL5205_Experiencia_Cubo.mat');

%% f1 = f11 + f21 u 
% Ecuacion completa
% (1/((c(1)+c(2) * cos(x(2))^2) * c(3))) * ((a(1) + a(2) * cos(x(2))) * sin(x(2)) * x(3)^2  ...
% + a(3) * sin(x(2)) * x(4) * x(3) + a(4) * sin(x(2)) * x(4)^2 + (a(5) + a(6) * cos(x(2))) * x(4) ... 
% + (a(7) + a(8) * cos(x(2)))u + a(9) * sin(x(1)) * cos(x(2))^2 + a(10) * sin(x(1)) + a(11) * cos(x(2)) * cos(x(1)) * sin(x(2)))

f11 = @(a,b,c,x) (1/((c(1)+c(2) * cos(x(2))^2) * c(3))) * ((a(1) + a(2) * cos(x(2))) * sin(x(2)) * x(3)^2  ...
+ a(3) * sin(x(2)) * x(4) * x(3) + a(4) * sin(x(2)) * x(4)^2 + (a(5) + a(6) * cos(x(2))) * x(4) ... 
+ a(9) * sin(x(1)) * cos(x(2))^2 + a(10) * sin(x(1)) + a(11) * cos(x(2)) * cos(x(1)) * sin(x(2)));

f21 = @(a,b,c,x) (1/((c(1)+c(2) * cos(x(2))^2) * c(3))) * (a(7) + a(8) * cos(x(2)));

%% f2 = f12 + f22 u 
% Ecuacion completa
% (1/((c(1)+c(2) * cos^2(x(2))^2) * c(3))) * ((b(1) + b(2) * cos(x(2))) * sin(x(2)) * x(3)^2 ...
% + (b(3) * cos(x(2)) + b(4))* sin(x(2)) * x(4) * x(1) + (b(5) + b(6) * cos(x(2)))* sin(x(2)) * x(4)^2 ...
% + (b(7) + b(8)* cos(x(2))) * x(4) + (b(9) + b(10) * cos(x(2)))u + (b(11) + b(12)* cos(x(2)))* sin(x(1)) ...
% + b(13) * sin(x(1)) * cos(x(2))^2 + b(14) * cos(x(1)) * sin(x(2)) + b(15) * cos(x(2))* sin(x(2))* cos(x(1)))


f12 = @(a,b,c,x) (1/((c(1)+c(2) * cos(x(2))^2) * c(3))) * ((b(1) + b(2) * cos(x(2))) * sin(x(2)) * x(3)^2 ...
+ (b(3) * cos(x(2)) + b(4))* sin(x(2)) * x(4) * x(1) + (b(5) + b(6) * cos(x(2)))* sin(x(2)) * x(4)^2 ...
+ (b(7) + b(8)* cos(x(2))) * x(4) + (b(11) + b(12)* cos(x(2)))* sin(x(1)) ...
+ b(13) * sin(x(1)) * cos(x(2))^2 + b(14) * cos(x(1)) * sin(x(2)) + b(15) * cos(x(2))* sin(x(2))* cos(x(1)));

f22 = @(a,b,c,x) (1/((c(1)+c(2) * cos(x(2))^2) * c(3))) * (b(9) + b(10) * cos(x(2)));